import{_ as U,m as k,z as g,a as A,o as l,c as n,b as s,F as f,u as b,y as i,e as _,g as w,x as T}from"./index-Bk2W6sNu.js";import{U as v}from"./UserState-D7ke27qt.js";import{a as d}from"./axios-Bo0ATomq.js";import{h as D}from"./moment-Cl4UOzQZ.js";var I={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"wuyi0020",VITE_ADMIN_USERNAME:"wuyi0020@gmail.com",VITE_ADMIN_PASSWORD:"wuyi0020",BASE_URL:"/pixelmissions/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const E=["userName","userEmail","userID","userHasLogIn","AdminToken","Alldata"],$=["checkUserLogin","getAlldata","PushUrl"],{VITE_URL:u,VITE_API_PATH:p}=I,V={data(){return{Orders:[],ThisUserOrders:[],pagination:{},Users:{}}},methods:{...k(v,$),Pay(e){const a=`${u}/api/${p}/pay/${e}`;d.post(a).then(c=>{g.success("付款成功")}).then(()=>{this.Orders=[],this.getOeder()})},deleteOrder(e){const a=`${u}/api/${p}/admin/order/${e}`;d.defaults.headers.common.Authorization=this.AdminToken,d.delete(a).then(c=>{g.success("刪除成功")}).then(()=>{this.Orders=[],this.getOeder()})},async getOeder(){d.defaults.headers.common.Authorization=this.AdminToken;let e=!0,a=1;for(;e;){const c=`${u}/api/${p}/orders?page=${a}`;await d.get(c).then(r=>{this.Orders=[...this.Orders,...r.data.orders],this.pagination=r.data.pagination,e=r.data.pagination.has_next,a++}).catch(()=>{e=!1})}this.ThisUserOrders=this.Orders.filter(c=>c.user.userid===this.userID)},getUsers(){Object.values(this.Alldata).forEach(e=>{e.category==="使用者"&&(this.Users[e.id]=e)})}},async mounted(){await this.getAlldata(),this.getOeder(),this.checkUserLogin(),this.getUsers()},computed:{...A(v,E),formattedTime(e){if(e===void 0)return"";const a=new Date(e);return D(a).format("YYYY-MM-DD")}}},P={class:"container"},S=s("div",{class:"row"},[s("h3",{class:"mt-5"},"委託訂單確認")],-1),N={class:"container"},L={class:"col-12 p-5 bg bg-dark-subtle rounded-5"},R={class:"col-md-4"},C=["src"],M={class:"col-md-8 d-flex flex-column"},z={class:"card-body"},B={key:0,class:"d-flex align-items-center"},Y=["src"],H={class:"mx-2 h3"},F={class:"card-title h3"},W={class:"mb-0"},j={class:""},q={class:""},G={class:""},J={key:0,class:"text-success"},K={class:"row gx-3"},Q={class:"col-9"},X=["onClick"],Z={class:"col-3"},ss=["onClick"],ts=s("i",{class:"bi bi-trash3"},null,-1),es=[ts],is={class:"col-12"},as=["data-bs-target","aria-controls"],os=s("i",{class:"bi bi-arrow-down-circle"},null,-1),ls=s("hr",null,null,-1),ns=["id"],cs=s("h3",null,"Email :",-1),ds=s("hr",null,null,-1),rs=s("h3",null,"姓名 :",-1),_s=s("hr",null,null,-1),hs=s("h3",null,"收件人地址 :",-1),us=s("hr",null,null,-1),ps=s("h3",null,"電話 :",-1),ms=s("hr",null,null,-1),gs=s("h3",null,"付款狀態 :",-1),fs=s("hr",null,null,-1),bs=s("h3",null,"留言訊息 :",-1);function vs(e,a,c,r,h,m){return l(),n("div",P,[S,s("div",N,[(l(!0),n(f,null,b(h.ThisUserOrders,(t,x)=>(l(),n("div",{class:"row mb-5",key:x},[s("div",L,[(l(!0),n(f,null,b(t.products,(o,y)=>(l(),n("div",{class:"row g-5",key:o.product.id+"order"+y},[s("div",R,[s("img",{src:o.product.imageUrl,class:"img-fluid rounded-start-0 ratio-1x1 mh-100",alt:"方案"},null,8,C)]),s("div",M,[s("div",z,[o.product.author?(l(),n("div",B,[s("img",{src:h.Users[o.product.author].imageUrl,width:"60px",class:"img-fluid ratio-1x1 rounded-circle",alt:"作者"},null,8,Y),s("span",H,i(h.Users[o.product.author].title),1)])):_("",!0),s("p",F,i(o.product.title),1),s("p",W,i(o.product.description),1),s("p",j,i(o.product.content),1)]),s("div",q,[s("span",G,i(o.total)+" TWD",1),t.is_paid?(l(),n("span",J,"(付款完成)")):_("",!0)]),s("div",K,[s("div",Q,[t.is_paid?_("",!0):(l(),n("button",{key:0,type:"button",class:"btn w-100 btn-primary btn-lg rounded-pill",onClick:O=>m.Pay(t.id)}," 前往付款 ",8,X))]),s("div",Z,[t.is_paid?_("",!0):(l(),n("button",{key:0,type:"button",class:"btn w-100 btn-outline-danger btn-lg rounded-pill",onClick:O=>m.deleteOrder(t.id)},es,8,ss))])])]),s("div",is,[s("h3",{type:"button","data-bs-toggle":"collapse","data-bs-target":`#collapseID${t.id}`,"aria-expanded":"false","aria-controls":`collapseID${t.id}`},[w(" 訂單資料"),os],8,as),ls,s("div",{id:`collapseID${t.id}`,class:"collapse"},[cs,s("p",null,i(t.user.email),1),ds,rs,s("p",null,i(t.user.name),1),_s,hs,s("p",null,i(t.user.address),1),us,ps,s("p",null,i(t.user.tel),1),ms,gs,s("p",{class:T({"text-danger":!t.is_paid,"text-success":t.is_paid})},i(t.is_paid?"完成付款":"尚未付款"),3),fs,bs,s("p",null,i(t.message?t.message:"沒有留言"),1)],8,ns)])]))),128))])]))),128))])])}const ks=U(V,[["render",vs]]);export{ks as default};
