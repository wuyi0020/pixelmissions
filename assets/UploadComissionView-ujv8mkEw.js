import{a as u}from"./axios-Bo0ATomq.js";import{U as f}from"./UserState-BoEKTuGp.js";import{_ as b,m as D,j as V,a as x,r as m,o as E,c as w,b as e,n as o,d as i,w as y}from"./index-CnB8nTM4.js";import{V as _,d as I,l as v,c as T,F as k,a as P,E as R,z as S}from"./zh_TW-Bl_OMvIC.js";var j={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"wuyi0020",VITE_ADMIN_USERNAME:"wuyi0020@gmail.com",VITE_ADMIN_PASSWORD:"wuyi0020",BASE_URL:"/undefined/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:h,VITE_API_PATH:g}=j,M=["AdminToken","userID"],z=["setAdminToken","checkUserLogin"];Object.keys(_).forEach(l=>{I(l,_[l])});v({zh_TW:S});T({generateMessage:v("zh_TW"),validateOnInput:!0});const F={components:{VField:k,VForm:P,ErrorMessage:R},data(){return{fileUrl:"",fileError:!1,ArtData:{author:"",category:"報價",content:"",description:"",imageUrl:"",is_enabled:1,like:0,sublist:[],origin_price:0,price:0,time:0,title:"",unit:"TWD"}}},mounted(){this.$refs.imgfileInput.addEventListener("change",this.imagePreview),this.setAdminToken(),this.checkUserLogin()},methods:{...D(f,z),imagePreview(){const l=this.$refs.imgfileInput.files[0],s=new FileReader;s.readAsDataURL(l),s.onload=r=>{this.fileUrl=r.target.result}},filechack(){this.fileUrl===""&&(this.fileError=!0)},uploadPrduct(){const l=new FormData,s=this.$refs.imgfileInput.files[0];l.append("file-to-upload",s);const r=`${h}/api/${g}/admin/upload`,p=`${h}/api/${g}/admin/product`;if(u.defaults.headers.common.Authorization=this.AdminToken,this.ArtData.author=this.userID,this.ArtData.time=new Date().getTime(),console.log(this.ArtData),this.fileUrl===""){this.fileError=!0;return}u.post(r,l).then(t=>(this.fileUrl=t.data.imageUrl,this.ArtData.imageUrl=t.data.imageUrl,console.log(this.ArtData),u.post(p,{data:this.ArtData}))).then(t=>{console.log(t),this.$router.push(`/usercenter/${this.userID}`),V.success("上傳成功")}).catch(t=>{console.log(t)})}},computed:{...x(f,M)}},L={class:"container mt-5"},W={class:"row"},B=e("div",{class:"col-12"},[e("h1",null,"上傳報價")],-1),N={class:"justify-content-center align-items-center flex-column d-flex"},O=["src"],q={type:"file",ref:"imgfileInput",id:"fileInput"},C={class:"col-12 col-md-9 col-lg-6 text-center"},H={class:"col-12 col-md-9 col-lg-6 text-center"},G=e("hr",null,null,-1),J={class:"row justify-content-center"},K={class:"input-group mb-3"},Q=e("span",{class:"input-group-text"},"報價單名稱",-1),X={class:"input-group mb-3"},Y=e("span",{class:"input-group-text",id:"basic-addon1"},"報價單描述",-1),Z={class:"input-group mb-3"},$=e("span",{class:"input-group-text",id:"basic-addon1"},"報價單內容",-1),ee={class:"input-group mb-3"},te=e("span",{class:"input-group-text",id:"basic-addon1"},"約稿價格",-1),se=e("span",{class:"input-group-text"},"TWD",-1),oe=e("button",{class:"btn btn-primary w-100 rounded-pill",type:"submit"}," 上傳 ",-1),ie=e("div",{class:"row justify-content-center"},null,-1),le=e("div",{id:"imagePreview"},null,-1);function ne(l,s,r,p,t,A){const a=m("v-field"),c=m("error-message"),U=m("v-form");return E(),w("div",L,[e("div",W,[B,e("div",N,[e("div",{class:o({"col-12 col-md-6 col-lg-3":t.fileUrl=="","col-12 col-md-9 col-lg-6":t.fileUrl!=""})},[e("div",{class:o(["d-flex justify-content-center mw-100 ratio ratio-1x1",{uploadStyle:t.fileUrl==""}])},[e("label",{class:o(["d-flex justify-content-center align-items-center btn btn-outline-secondary rounded-3",{"border-danger-subtle":t.fileError}])},[e("img",{src:t.fileUrl,ref:"imagePreview2",class:"mw-100 ratio-1x1"},null,8,O),e("input",q,null,512),e("h1",{class:o(["m-0 p-0",{"d-block":t.fileUrl=="","d-none":t.fileUrl!="","text-danger":t.fileError}])}," + ",2)],2)],2)],2),e("div",C,[e("p",{class:o(["w-100 text-danger-emphasis mt-3 mb-0",{"d-none":!t.fileError}])}," 需要上傳圖片 ",2)]),e("div",H,[e("p",{class:o(["w-100 text-secondary mt-3 mb-0",{"text-secondary":!t.fileError,"text-danger-emphasis ":t.fileError}])}," 檔案大小限制為 3MB 以下，接受格式為 jpg jpeg png ",2)])])]),G,e("div",J,[i(U,{class:"col-12 col-md-9 col-lg-6 text-center",ref:"form",onSubmit:A.uploadPrduct},{default:y(({errors:d})=>[e("div",K,[Q,i(a,{id:"title",name:"報價單名稱",type:"",class:o(["form-control",{"is-invalid":d.報價單名稱}]),placeholder:"報價單名稱",rules:"required",modelValue:t.ArtData.title,"onUpdate:modelValue":s[0]||(s[0]=n=>t.ArtData.title=n)},null,8,["class","modelValue"]),i(c,{name:"報價單名稱",class:"invalid-feedback"})]),e("div",X,[Y,i(a,{id:"description",name:"報價單簡單描述",type:"",class:o([{"is-invalid":d.報價單簡單描述},"form-control"]),placeholder:"報價單簡單描述",rules:"required",modelValue:t.ArtData.description,"onUpdate:modelValue":s[1]||(s[1]=n=>t.ArtData.description=n)},null,8,["class","modelValue"]),i(c,{name:"報價單簡單描述",class:"invalid-feedback"})]),e("div",Z,[$,i(a,{id:"content",name:"報價單內容",type:"",class:o([{"is-invalid":d.報價單內容},"form-control"]),placeholder:"報價單內容",rules:"required",modelValue:t.ArtData.content,"onUpdate:modelValue":s[2]||(s[2]=n=>t.ArtData.content=n)},null,8,["class","modelValue"]),i(c,{name:"報價單內容",class:"invalid-feedback"})]),e("div",ee,[te,i(a,{id:"price",name:"約稿價格",type:"number",class:o([{"is-invalid":d.約稿價格},"form-control"]),placeholder:"約稿價格",rules:"required",modelValue:t.ArtData.price,"onUpdate:modelValue":s[3]||(s[3]=n=>t.ArtData.price=n)},null,8,["class","modelValue"]),se,i(c,{name:"約稿價格",class:"invalid-feedback"})]),oe]),_:1},8,["onSubmit"])]),ie,le])}const ue=b(F,[["render",ne]]);export{ue as default};
