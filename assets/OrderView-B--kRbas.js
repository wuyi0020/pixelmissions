import{_ as A,m as k,j as p,a as w,o as n,c as l,b as s,F as g,h as f,t as o,e as _,g as D,n as T}from"./index-CnB8nTM4.js";import{U as b}from"./UserState-BoEKTuGp.js";import{a as d}from"./axios-Bo0ATomq.js";import{h as I}from"./moment-Cl4UOzQZ.js";var O={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"wuyi0020",VITE_ADMIN_USERNAME:"wuyi0020@gmail.com",VITE_ADMIN_PASSWORD:"wuyi0020",BASE_URL:"/undefined/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const E=["userName","userEmail","userID","userHasLogIn","AdminToken","Alldata"],$=["checkUserLogin","getAlldata","PushUrl"],{VITE_URL:u,VITE_API_PATH:m}=O,V={data(){return{Orders:[],ThisUserOrders:[],pagination:{},Users:{}}},methods:{...k(b,$),Pay(e){const a=`${u}/api/${m}/pay/${e}`;d.post(a).then(c=>{p.success("付款成功")})},deleteOrder(e){const a=`${u}/api/${m}/admin/orders/${e}`;d.defaults.headers.common.Authorization=this.AdminToken,d.delete(a).then(c=>{p.success("刪除成功")})},async getOeder(){d.defaults.headers.common.Authorization=this.AdminToken;let e=!0,a=1;for(;e;){const c=`${u}/api/${m}/orders?page=${a}`;console.log(a),await d.get(c).then(r=>{this.Orders=[...this.Orders,...r.data.orders],this.pagination=r.data.pagination,e=r.data.pagination.has_next,a++}).catch(r=>{e=!1,console.log(r)})}this.ThisUserOrders=this.Orders.filter(c=>c.user.userid===this.userID)},getUsers(){Object.values(this.Alldata).forEach(e=>{e.category==="使用者"&&(this.Users[e.id]=e)})}},async mounted(){await this.getAlldata(),this.getOeder(),this.checkUserLogin(),this.getUsers()},computed:{...w(b,E),formattedTime(e){if(e===void 0)return"";const a=new Date(e);return I(a).format("YYYY-MM-DD")}}},P={class:"container"},S=s("div",{class:"row"},[s("h1",{class:"mt-5"},"委託訂單確認")],-1),N={class:"container"},L={class:"col-12 p-5 bg bg-dark-subtle rounded-5"},R={class:"col-md-4"},C=["src"],M={class:"col-md-8 d-flex flex-column"},B={class:"card-body"},Y={key:0,class:"d-flex align-items-center"},z=["src"],H={class:"mx-2 fs-4"},j={class:"card-title"},F={class:"fs-3 text-secondary mb-0"},W={class:"fs-3 text-secondary"},q={class:"text-center fs-2"},G={class:""},J={class:"row gx-3"},K={class:"col-9"},Q=["onClick"],X={class:"col-3"},Z=["onClick"],ss={class:"col-12"},ts=["data-bs-target","aria-controls"],es=s("i",{class:"bi bi-arrow-down-circle"},null,-1),os=s("hr",null,null,-1),as=["id"],is=s("h2",null,"Email :",-1),ns=s("hr",null,null,-1),ls=s("h2",null,"姓名 :",-1),cs=s("hr",null,null,-1),rs=s("h2",null,"收件人地址 :",-1),ds=s("hr",null,null,-1),hs=s("h2",null,"電話 :",-1),_s=s("hr",null,null,-1),us=s("h2",null,"付款狀態 :",-1),ms=s("hr",null,null,-1),ps=s("h2",null,"留言訊息 :",-1);function gs(e,a,c,r,h,v){return n(),l("div",P,[S,s("div",N,[(n(!0),l(g,null,f(h.ThisUserOrders,(t,y)=>(n(),l("div",{class:"row mb-5",key:y},[s("div",L,[(n(!0),l(g,null,f(t.products,(i,x)=>(n(),l("div",{class:"row g-5",key:i.product.id+"order"+x},[s("div",R,[s("img",{src:i.product.imageUrl,class:"img-fluid rounded-start-0 ratio-1x1 mh-100"},null,8,C)]),s("div",M,[s("div",B,[i.product.author?(n(),l("div",Y,[s("img",{src:h.Users[i.product.author].imageUrl,width:"60px",class:"img-fluid ratio-1x1 rounded-circle"},null,8,z),s("span",H,o(h.Users[i.product.author].title),1)])):_("",!0),s("h1",j,o(i.product.title),1),s("p",F,o(i.product.description),1),s("p",W,o(i.product.content),1)]),s("div",q,[s("span",G,o(i.total)+" TWD",1)]),s("div",J,[s("div",K,[t.is_paid?_("",!0):(n(),l("button",{key:0,type:"button",class:"btn w-100 btn-primary btn-lg rounded-pill",onClick:U=>v.Pay(t.id)}," 前往付款 ",8,Q))]),s("div",X,[t.is_paid?_("",!0):(n(),l("button",{key:0,type:"button",class:"btn w-100 btn-outline-danger btn-lg rounded-pill",onClick:U=>e.DeletOrder(t.id)}," 刪除訂單 ",8,Z))])])]),s("div",ss,[s("h1",{type:"button","data-bs-toggle":"collapse","data-bs-target":`#collapseID${t.id}`,"aria-expanded":"false","aria-controls":`collapseID${t.id}`},[D(" 訂單資料"),es],8,ts),os,s("div",{id:`collapseID${t.id}`,class:"collapse"},[is,s("h3",null,o(t.user.email),1),ns,ls,s("h3",null,o(t.user.name),1),cs,rs,s("h3",null,o(t.user.address),1),ds,hs,s("h3",null,o(t.user.tel),1),_s,us,s("h3",{class:T({"text-danger":!t.is_paid,"text-success":t.is_paid})},o(t.is_paid?"完成付款":"尚未付款"),3),ms,ps,s("h3",null,o(t.message?t.message:"沒有留言"),1)],8,as)])]))),128))])]))),128))])])}const xs=A(V,[["render",gs]]);export{xs as default};
